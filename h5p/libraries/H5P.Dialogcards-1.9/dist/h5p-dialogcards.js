!function(){"use strict";var r=H5P.jQuery,t=function(){function t(t,a,e,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return this.card=t,this.params=a||{},this.id=e,this.contentId=i,this.callbacks=n,this.card.back.useImageFromFront&&(this.card.back.image=this.card.front.image,this.card.back.imageAltText=this.card.front.imageAltText),this.card.back.useAudioFromFront&&(this.card.back.audio=this.card.front.audio),this.audios={},this.$audioWrappers={},this.$cardWrapper=r("<div>",{class:"h5p-dialogcards-cardwrap",role:"group",tabindex:"-1"}),"repetition"!==this.params.mode&&this.$cardWrapper.attr("aria-labelledby","h5p-dialogcards-progress-"+H5P.Dialogcards.idCounter),this.$cardHolder=r("<div>",{class:"h5p-dialogcards-cardholder"}).appendTo(this.$cardWrapper),this.createCardContent(t).appendTo(this.$cardHolder),this}var a=t.prototype;return a.createCardContent=function(t){var a=r("<div>",{class:"h5p-dialogcards-card-content"});this.$imageWrapper=r("<div>",{class:"h5p-dialogcards-image-wrapper"}),this.createCardImage(t,"front").appendTo(this.$imageWrapper),this.createCardImage(t,"back").appendTo(this.$imageWrapper),this.$imageWrapper.appendTo(a);var e=r("<div>",{class:"h5p-dialogcards-card-text-wrapper"}).appendTo(a),i=r("<div>",{class:"h5p-dialogcards-card-text-inner"}).appendTo(e),n=r("<div>",{class:"h5p-dialogcards-card-text-inner-content"}).appendTo(i);this.$audioWrappers.front=this.createCardAudio(t,"front").appendTo(n),this.$audioWrappers.back=this.createCardAudio(t,"back").appendTo(n);var s=r("<div>",{class:"h5p-dialogcards-card-text"}).appendTo(n);return this.$cardTextArea=r("<div>",{class:"h5p-dialogcards-card-text-area",tabindex:"-1",html:t.front.text}).appendTo(s),this.createCardFooter().appendTo(e),a},a.createCardImage=function(t,a){var e;return void 0!==t[a].image?((e=r('<img class="h5p-dialogcards-image" src="'+H5P.getPath(t[a].image.path,this.contentId)+'"/>')).addClass("h5p-dialogcards-image-".concat(a)),t[a].imageAltText&&e.attr("alt",t[a].imageAltText)):e=r('<div class="h5p-dialogcards-image"></div>'),e},a.createCardAudio=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"front",e=r("<div>").addClass("h5p-dialogcards-audio-wrapper").addClass("h5p-dialogcards-audio-wrapper-".concat(a));if(t[a].text&&""!==t[a].text||e.addClass("h5p-no-text"),void 0!==t[a].audio){var i={files:t[a].audio,audioNotSupported:this.params.audioNotSupported},n=new H5P.Audio(i,this.contentId);this.audios[a]=n,n.attach(e),n.audio&&n.audio.preload&&(n.audio.preload="none")}else e.addClass("hide");return e},a.createCardFooter=function(){var t=r("<div>",{class:"h5p-dialogcards-card-footer"}),a="h5p-dialogcards-button-hidden",e="-1";return"repetition"===this.params.mode&&(a="",this.params.behaviour.quickProgression&&(a="h5p-dialogcards-quick-progression",e="0"),t.addClass("h5p-repetition")),this.$buttonTurn=H5P.JoubelUI.createButton({class:"h5p-dialogcards-turn",html:this.params.answer}).appendTo(t),this.$buttonShowSummary=H5P.JoubelUI.createButton({class:"h5p-dialogcards-show-summary h5p-dialogcards-button-gone",html:this.params.showSummary}).appendTo(t),this.$buttonIncorrect=H5P.JoubelUI.createButton({class:"h5p-dialogcards-answer-button",html:this.params.incorrectAnswer}).addClass("incorrect").addClass(a).attr("tabindex",e).appendTo(t),this.$buttonCorrect=H5P.JoubelUI.createButton({class:"h5p-dialogcards-answer-button",html:this.params.correctAnswer}).addClass("correct").addClass(a).attr("tabindex",e).appendTo(t),t},a.createButtonListeners=function(){var r=this;this.$buttonIncorrect.unbind("click").click((function(t){t.target.classList.contains("h5p-dialogcards-quick-progression")&&r.callbacks.onNextCard({cardId:r.id,result:!1})})),this.$buttonTurn.unbind("click").click((function(){r.turnCard()})),this.$buttonCorrect.unbind("click").click((function(t){t.target.classList.contains("h5p-dialogcards-quick-progression")&&r.callbacks.onNextCard({cardId:r.id,result:!0})}))},a.showSummaryButton=function(r){this.getDOM().find(".h5p-dialogcards-answer-button").addClass("h5p-dialogcards-button-hidden").attr("tabindex","-1"),this.$buttonTurn.addClass("h5p-dialogcards-button-gone"),this.$buttonShowSummary.click((function(){return r()})).removeClass("h5p-dialogcards-button-gone").focus()},a.hideSummaryButton=function(){"normal"!==this.params.mode&&(this.getDOM().find(".h5p-dialogcards-answer-button").removeClass("h5p-dialogcards-button-hidden").attr("tabindex","0"),this.$buttonTurn.removeClass("h5p-dialogcards-button-gone"),this.$buttonShowSummary.addClass("h5p-dialogcards-button-gone"))},a.turnCard=function(){var r=this,t=this.getDOM(),a=t.find(".h5p-dialogcards-card-content"),e=t.find(".h5p-dialogcards-cardholder").addClass("h5p-dialogcards-collapse");a.find(".joubel-tip-container").remove(),setTimeout((function(){var i=r.isTurned();if(a.toggleClass("h5p-dialogcards-turned",!i),e.removeClass("h5p-dialogcards-collapse"),r.changeText(i?r.getText():r.getAnswer()),r.stopAudio(),"repetition"===r.params.mode&&!r.params.behaviour.quickProgression){var n=t.find(".h5p-dialogcards-answer-button");!1===n.hasClass("h5p-dialogcards-quick-progression")&&n.addClass("h5p-dialogcards-quick-progression").attr("tabindex",0)}setTimeout((function(){r.addTipToCard(a,i?"front":"back"),"function"==typeof r.callbacks.onCardTurned&&r.callbacks.onCardTurned(i)}),200),r.resizeOverflowingText(),r.$cardTextArea.focus()}),200)},a.changeText=function(r){this.$cardTextArea.html(r),this.$cardTextArea.toggleClass("hide",!r||!r.length)},a.setProgressText=function(r,t){if("repetition"===this.params.mode){var a=this.params.progressText.replace("@card",r.toString()).replace("@total",t.toString());this.$cardWrapper.attr("aria-label",a)}},a.resizeOverflowingText=function(){if(this.params.behaviour.scaleTextNotCard){var r=this.getDOM().find(".h5p-dialogcards-card-text"),t=r.children();this.resizeTextToFitContainer(r,t)}},a.resizeTextToFitContainer=function(r,a){if(a.css("font-size",""),90===window.orientation){var e=this.getDOM().find(".h5p-dialogcards-card-text-inner").get(0);if(e.clientHeight<e.scrollHeight)for(var i=parseFloat(a.css("font-size"));i>t.MINSCALE&&e.clientHeight<e.scrollHeight;)i-=t.SCALEINTERVAL,a.css("font-size","".concat(i,"px"))}else{var n=r.get(0).getBoundingClientRect().height,s=a.get(0).getBoundingClientRect().height,o=parseFloat(r.css("font-size")),d=parseFloat(a.css("font-size")),c=this.getDOM().closest(".h5p-container"),l=parseFloat(c.css("font-size"));if(s>n)for(var u=!0;u;){if((d-=t.SCALEINTERVAL)<t.MINSCALE){u=!1;break}a.css("font-size",d/o+"em"),(s=a.get(0).getBoundingClientRect().height)<=n&&(u=!1)}else for(var h=!0;h;){if((d+=t.SCALEINTERVAL)>l){h=!1;break}a.css("font-size",d/o+"em"),(s=a.get(0).getBoundingClientRect().height)>=n&&(h=!1,d-=t.SCALEINTERVAL,a.css("font-size",d/o+"em"))}}},a.addTipToCard=function(r,t,a){"back"!==t&&(t="front"),void 0===a&&(a=this.id),r.find(".joubel-tip-container").remove();var e=(this.card[t].tip||"").trim();e.length&&r.find(".h5p-dialogcards-card-text-wrapper .h5p-dialogcards-card-text-inner").after(H5P.JoubelUI.createTip(e,{tipLabel:this.params.tipButtonLabel}))},a.setCardFocus=function(r){if(!0===r)this.$cardTextArea.focus();else{var t=this.getDOM();t.one("transitionend",(function(){t.focus()}))}},a.stopAudio=function(){var r=this;["front","back"].forEach((function(t){r.audios[t]&&r.audios[t].audio&&(r.audios[t].audio.duration>0&&(r.audios[t].audio.pause(),r.audios[t].audio.currentTime=Math.floor(r.audios[t].audio.duration)),r.audios[t].audio.load&&setTimeout((function(){r.audios[t].audio.load()}),100))}))},a.getDOM=function(){return this.$cardWrapper},a.setNoText=function(){this.getDOM().addClass("h5p-no-text")},a.getText=function(){return this.card.front.text},a.getAnswer=function(){return this.card.back.text},a.getImageWrapper=function(){return this.$imageWrapper},a.setImageHeight=function(r){this.$imageWrapper.css("height",r)},a.getAudio=function(){return this.isTurned()?this.$audioWrappers.back:this.$audioWrappers.front},a.isTurned=function(){return this.getDOM().find(".h5p-dialogcards-card-content").hasClass("h5p-dialogcards-turned")},a.reset=function(){var r=this.getDOM();r.removeClass("h5p-dialogcards-previous"),r.removeClass("h5p-dialogcards-current"),this.changeText(this.getText());var t=r.find(".h5p-dialogcards-card-content");t.removeClass("h5p-dialogcards-turned"),this.addTipToCard(t,"front",this.id),this.params.behaviour.quickProgression||r.find(".h5p-dialogcards-answer-button").removeClass("h5p-dialogcards-quick-progression"),this.hideSummaryButton()},t}();t.SCALEINTERVAL=.2,t.MAXSCALE=16,t.MINSCALE=4;var a=t,e=function(){function r(r,t,a){var e=this;return this.params=r,this.contentId=t,this.callbacks=a,this.cards=[],this.params.dialogs.forEach((function(r,t){r.id=t,e.cards.push(t)})),this}var t=r.prototype;return t.getCard=function(r){if(!(r<0||r>this.cards.length))return"number"==typeof this.cards[r]&&this.loadCard(r),this.cards[r]},t.getCardIds=function(){return this.cards.map((function(r,t){return t}))},t.loadCard=function(r){r<0||r>this.cards.length||"number"==typeof this.cards[r]&&(this.cards[r]=new a(this.params.dialogs[r],this.params,r,this.contentId,this.callbacks))},r}();function i(r){return function(r){if(Array.isArray(r))return n(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"==typeof r)return n(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);"Object"===a&&r.constructor&&(a=r.constructor.name);if("Map"===a||"Set"===a)return Array.from(r);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(r,t){(null==t||t>r.length)&&(t=r.length);for(var a=0,e=new Array(t);a<t;a++)e[a]=r[a];return e}var s=function(){function r(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.cards=r.filter((function(t,a){return r.indexOf(t)>=a})),this}var t=r.prototype;return t.getCards=function(){return this.cards},t.peek=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=Math.max(0,t),"top"===r&&(r=0),"bottom"===r&&(r=this.cards.length-t),r<0||r>this.cards.length-1?[]:this.cards.slice(r,r+t)},t.add=function(r){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top";"number"==typeof r&&(r=[r]),r.forEach((function(e){var n;-1===t.cards.indexOf(e)&&("top"===a?a=0:"bottom"===a?a=t.cards.length:"random"===a&&(a=Math.floor(Math.random()*t.cards.length)),(n=t.cards).splice.apply(n,[a,0].concat(i(r))))}))},t.push=function(r){this.add(r,"top")},t.pull=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top";return r=Math.max(1,Math.min(r,this.cards.length)),"top"===t&&(t=0),"bottom"===t&&(t=-r),t=Math.max(0,Math.min(t,this.cards.length-1)),this.cards.splice(t,r)},t.remove=function(r){var t=this;"number"==typeof r&&(r=[r]),r.forEach((function(r){var a=t.cards.indexOf(r);a>-1&&t.cards.splice(a,1)}))},t.shuffle=function(){for(var r=this.cards.length-1;r>0;r--){var t=Math.floor(Math.random()*(r+1)),a=[this.cards[t],this.cards[r]];this.cards[r]=a[0],this.cards[t]=a[1]}return this.cards},t.contains=function(r){return-1!==this.cards.indexOf(r)},t.length=function(){return this.cards.length},r}(),o=s;function d(r){return function(r){if(Array.isArray(r))return c(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"==typeof r)return c(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);"Object"===a&&r.constructor&&(a=r.constructor.name);if("Map"===a||"Set"===a)return Array.from(r);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(r,t){(null==t||t>r.length)&&(t=r.length);for(var a=0,e=new Array(t);a<t;a++)e[a]=r[a];return e}var l=function(){function r(r,t,a){return this.params=r,this.cardPool=new e(r,t,a),this.reset(r.cardPiles),this}var t=r.prototype;return t.createSelection=function(){var r=[];if("repetition"===this.params.mode)r=this.createSelectionRepetition();else r=this.cardPool.getCardIds();return r},t.createPiles=function(r){if(r)this.cardPiles=r.map((function(r){return new o(r.cards)}));else{this.cardPiles=[];var t=this.cardPool.getCardIds();switch(this.params.mode){case"repetition":for(var a=0;a<this.params.behaviour.maxProficiency;a++)0===a?this.cardPiles.push(new o(t)):this.cardPiles.push(new o);break;case"normal":this.cardPiles.push(new o(t))}}},t.updatePiles=function(r){var t=this;return r.forEach((function(r){var a=t.find(r.cardId);if(-1!==a){var e=!0===r.result?a+1:0;e=Math.max(0,Math.min(e,t.cardPiles.length-1)),t.cardPiles[a].remove(r.cardId),t.cardPiles[e].add(r.cardId,"bottom")}})),this.getPileSizes()},t.createSelectionRepetition=function(){for(var r=[],t=null,a=0;a<this.cardPiles.length-1;a++){var e,i=this.cardPiles[a].length();if(null!==t||0!==i){null===t&&(t=a);var n=Math.ceil(1*i/(1+a-t)),s=this.cardPiles[a].peek(0,n);r=(e=r).concat.apply(e,d(s))}}return r=this.shuffle(r)},t.shuffle=function(r){for(var t=r.slice(),a=t.length-1;a>0;a--){var e=Math.floor(Math.random()*(a+1)),i=[t[e],t[a]];t[a]=i[0],t[e]=i[1]}return t},t.find=function(r){var t=-1;return this.cardPiles.forEach((function(a,e){if(-1!==t)return t;a.contains(r)&&(t=e)})),t},t.reset=function(r){this.createPiles(r)},t.getCard=function(r){return this.cardPool.getCard(r)},t.getSize=function(){return this.cardPool.getCardIds().length},t.getPiles=function(){return this.cardPiles},t.getPileSizes=function(){return this.cardPiles.map((function(r){return r.length()}))},r}(),u=function(){function r(r,t){var a=this;this.params=r,this.callbacks=t,this.currentCallback=t.nextRound,this.fields=[],this.container=document.createElement("div"),this.container.classList.add("h5p-dialogcards-summary-screen");var e=this.createContainerDOM(r.summary);this.fields.round=e.getElementsByClassName("h5p-dialogcards-summary-subheader")[0],this.fields["h5p-dialogcards-round-cards-right"]=this.addTableRow(e,{category:this.params.summaryCardsRight,symbol:"h5p-dialogcards-check"}),this.fields["h5p-dialogcards-round-cards-wrong"]=this.addTableRow(e,{category:this.params.summaryCardsWrong,symbol:"h5p-dialogcards-times"}),this.fields["h5p-dialogcards-round-cards-not-shown"]=this.addTableRow(e,{category:this.params.summaryCardsNotShown});var i=this.createContainerDOM(r.summaryOverallScore);this.fields["h5p-dialogcards-overall-cards-completed"]=this.addTableRow(i,{category:this.params.summaryCardsCompleted,symbol:"h5p-dialogcards-check"}),this.fields["h5p-dialogcards-overall-completed-rounds"]=this.addTableRow(i,{category:this.params.summaryCompletedRounds,symbol:""});var n=document.createElement("div");n.classList.add("h5p-dialogcards-summary-message"),this.fields.message=n;var s=H5P.JoubelUI.createButton({class:"h5p-dialogcards-buttonNextRound",title:this.params.nextRound.replace("@round",2),html:this.params.nextRound.replace("@round",2)}).click(this.currentCallback).get(0);this.fields.button=s;var o=H5P.JoubelUI.createButton({class:"h5p-dialogcards-button-restart",title:this.params.startOver,html:this.params.startOver}).get(0),d=this.createConfirmationDialog({l10n:this.params.confirmStartingOver,instance:this},(function(){setTimeout((function(){a.callbacks.retry()}),100)}));o.addEventListener("click",(function(r){d.show(r.target.offsetTop)})),this.fields.buttonStartOver=o;var c=document.createElement("div");return c.classList.add("h5p-dialogcards-summary-footer"),c.appendChild(o),c.appendChild(s),this.container.appendChild(e),this.container.appendChild(i),this.container.appendChild(n),this.container.appendChild(c),this.hide(),this}var t=r.prototype;return t.getDOM=function(){return this.container},t.createContainerDOM=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=document.createElement("div");a.classList.add("h5p-dialogcards-summary-container");var e=document.createElement("div");e.classList.add("h5p-dialogcards-summary-header"),e.innerHTML=r,a.appendChild(e);var i=document.createElement("div");i.classList.add("h5p-dialogcards-summary-subheader"),i.innerHTML=t,a.appendChild(i);var n=document.createElement("table");return n.classList.add("h5p-dialogcards-summary-table"),a.appendChild(n),a},t.addTableRow=function(r,t){var a=r.getElementsByClassName("h5p-dialogcards-summary-table")[0],e=document.createElement("tr"),i=document.createElement("td");i.classList.add("h5p-dialogcards-summary-table-row-category"),i.innerHTML=t.category,e.appendChild(i);var n=document.createElement("td");n.classList.add("h5p-dialogcards-summary-table-row-symbol"),void 0!==t.symbol&&""!==t.symbol&&n.classList.add(t.symbol),e.appendChild(n);var s=document.createElement("td");return s.classList.add("h5p-dialogcards-summary-table-row-score"),e.appendChild(s),a.appendChild(e),s},t.update=function(){var r=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.done,e=void 0!==a&&a,i=t.round,n=void 0===i?void 0:i,s=t.message,o=void 0===s?void 0:s,d=t.results,c=void 0===d?[]:d;!0===e?(this.fields.buttonStartOver.classList.add("h5p-dialogcards-button-gone"),this.params.behaviour.enableRetry?(this.fields.button.classList.remove("h5p-dialogcards-button-next-round"),this.fields.button.classList.add("h5p-dialogcards-button-restart"),this.fields.button.innerHTML=this.params.retry,this.fields.button.title=this.params.retry,this.currentCallback=this.callbacks.retry):this.fields.button.classList.add("h5p-dialogcards-button-gone")):(this.fields.buttonStartOver.classList.remove("h5p-dialogcards-button-gone"),this.fields.button.classList.add("h5p-dialogcards-button-next-round"),this.fields.button.classList.remove("h5p-dialogcards-button-restart"),this.fields.button.innerHTML=this.params.nextRound,this.fields.button.title=this.params.nextRound,this.currentCallback=this.callbacks.nextRound),H5P.jQuery(this.fields.button).unbind("click").click(this.currentCallback),this.fields.round.innerHTML=this.params.round.replace("@round",n),e||void 0===n||(this.fields.button.innerHTML=this.params.nextRound.replace("@round",n+1),this.fields.button.title=this.params.nextRound.replace("@round",n+1)),e&&void 0!==o&&""!==o?(this.fields.message.classList.remove("h5p-dialogcards-gone"),this.fields.message.innerHTML=o):this.fields.message.classList.add("h5p-dialogcards-gone"),c.forEach((function(t){var a=void 0!==t.score.value?t.score.value:"";void 0!==t.score.max&&(a="".concat(a,'&nbsp;<span class="h5p-dialogcards-summary-table-row-score-divider">/</span>&nbsp;').concat(t.score.max)),r.fields[t.field].innerHTML=a}))},t.show=function(){this.container.classList.remove("h5p-dialogcards-gone"),this.fields.button.focus()},t.hide=function(){this.container.classList.add("h5p-dialogcards-gone")},t.createConfirmationDialog=function(r,t){r=r||{};var a=new H5P.ConfirmationDialog({instance:r.instance,headerText:r.l10n.header,dialogText:r.l10n.body,cancelText:r.l10n.cancelLabel,confirmText:r.l10n.confirmLabel});return a.on("confirmed",(function(){t()})),a.appendTo(this.getContainer()),a},t.getContainer=function(){var r=H5P.jQuery('[data-content-id="'+self.contentId+'"].h5p-content'),t=r.parents(".h5p-container");return(0!==t.length?t.last():0!==r.length?r:H5P.jQuery(document.body)).get(0)},r}(),h=u;function p(r,t){return p=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r},p(r,t)}var g=H5P.jQuery,m=H5P.JoubelUI,f=function(r){var t,a;function e(t,a,i){var n;return e.idCounter++,(n=r.call(this)||this).contentId=n.id=a,n.previousState=i.previousState||{},n.contentData=i||{},t.dialogs=t.dialogs||[],t.dialogs=t.dialogs.filter((function(r){if(!r.front||!r.back)return!1;if(!r.front.text&&!r.front.image&&!r.front.audio)return!1;var t=!r.back.text,a=r.back.useImageFromFront&&!r.front.image||!r.back.useImageFromFront&&!r.back.image,e=r.back.useAudioFromFront&&!r.front.audio||!r.back.useAudioFromFront&&!r.back.audio;return!(t&&a&&e)})),n.params=g.extend(!0,{title:"",mode:"normal",description:"Sit in pairs and make up sentences where you include the expressions below.<br/>Example: I should have said yes, HOWEVER I kept my mouth shut.",next:"Next",prev:"Previous",retry:"Retry",answer:"Turn",correctAnswer:"I got it right!",incorrectAnswer:"I got it wrong",round:"Round @round",cardsLeft:"Cards left: @number",nextRound:"Proceed to round @round",startOver:"Start over",showSummary:"Next",summary:"Summary",summaryCardsRight:"Cards you got right:",summaryCardsWrong:"Cards you got wrong:",summaryCardsNotShown:"Cards in pool not shown:",summaryOverallScore:"Overall Score",summaryCardsCompleted:"Cards you have completed learning:",summaryCompletedRounds:"Completed rounds:",summaryAllDone:"Well done! You got all @cards cards correct @max times in a row each!",progressText:"Card @card of @total",cardFrontLabel:"Card front",cardBackLabel:"Card back",tipButtonLabel:"Show tip",audioNotSupported:"Your browser does not support this audio",confirmStartingOver:{header:"Start over?",body:"All progress will be lost. Are you sure you want to start over?",cancelLabel:"Cancel",confirmLabel:"Start over"},dialogs:[{front:{text:"Horse"},back:{text:"Hest",useImageFromFront:!0,useAudioFromFront:!1}}],behaviour:{enableRetry:!0,disableBackwardsNavigation:!1,scaleTextNotCard:!1,randomCards:!1,maxProficiency:5,quickProgression:!1}},t),n.hasNoTexts=n.params.dialogs.every((function(r){return""===r.front.text&&""===r.back.text})),n.hasNoAudios=!n.params.dialogs.some((function(r){return r.front.audio||r.back.audio&&!r.back.useAudioFromFront})),n.cards=[],n.currentCardId=0,n.round=0,n.results=n.previousState.results||[],screen.orientation?screen.orientation.addEventListener("change",(function(){n.handleOrientationChange()})):window.addEventListener("orientationchange",(function(){n.handleOrientationChange()})),n.attach=function(r){n.$inner=r.addClass("h5p-dialogcards"),n.params.behaviour.scaleTextNotCard&&r.addClass("h5p-text-scaling");var t={mode:n.params.mode,dialogs:n.params.dialogs,audioNotSupported:n.params.audioNotSupported,answer:n.params.answer,showSummary:n.params.showSummary,incorrectAnswer:n.params.incorrectAnswer,correctAnswer:n.params.correctAnswer,progressText:n.params.progressText,tipButtonLabel:n.params.tipButtonLabel,behaviour:{scaleTextNotCard:n.params.behaviour.scaleTextNotCard,maxProficiency:n.params.behaviour.maxProficiency,quickProgression:n.params.behaviour.quickProgression},cardPiles:n.previousState.cardPiles};n.cardManager=new l(t,n.id,{onCardTurned:n.handleCardTurned,onNextCard:n.nextCard}),n.createDOM(0===n.round),void 0!==n.previousState.currentCardId&&(n.gotoCard(n.previousState.currentCardId),"repetition"===n.params.mode&&n.results.length===n.cardIds.length&&n.showSummary(!0)),n.updateNavigation(),n.trigger("resize")},n.createDOM=function(r){if(n.cardIds=r&&n.previousState.cardIds?n.previousState.cardIds:n.cardManager.createSelection(),n.cardPoolSize=n.cardPoolSize||n.cardManager.getSize(),!0===r){var t=g("<div>"+n.params.title+"</div>").text().trim();n.$header=g((t?'<div class="h5p-dialogcards-title"><div class="h5p-dialogcards-title-inner">'+n.params.title+"</div></div>":"")+'<div class="h5p-dialogcards-description">'+n.params.description+"</div>"),n.summaryScreen=new h(n.params,{nextRound:n.nextRound,retry:n.restartRepetition})}!0===r?n.$cardwrapperSet=n.initCards(n.cardIds):(n.$cardwrapperSet.detach(),n.$cardwrapperSet=n.initCards(n.cardIds),n.$cardSideAnnouncer.before(n.$cardwrapperSet)),n.$cardwrapperSet.prepend(n.summaryScreen.getDOM()),!0===r&&(n.$cardSideAnnouncer=g("<div>",{html:n.params.cardFrontLabel,class:"h5p-dialogcards-card-side-announcer","aria-live":"polite","aria-hidden":"true"}),n.$footer=n.createFooter(),n.$mainContent=g("<div>").append(n.$header).append(n.$cardwrapperSet).append(n.$cardSideAnnouncer).append(n.$footer).appendTo(n.$inner),n.hasNoTexts&&n.cards.forEach((function(r){r.setNoText()})),n.on("reset",(function(){this.reset()})),n.on("resize",n.resize),n.round=void 0!==n.previousState.round?n.previousState.round:1)},n.createFooter=function(){var r=g("<nav>",{class:"h5p-dialogcards-footer",role:"navigation"});return"normal"===n.params.mode?(n.$prev=m.createButton({class:"h5p-dialogcards-footer-button h5p-dialogcards-prev truncated","aria-label":n.params.prev,title:n.params.prev}).click((function(){n.prevCard()})).appendTo(r),n.$next=m.createButton({class:"h5p-dialogcards-footer-button h5p-dialogcards-next truncated","aria-label":n.params.next,title:n.params.next}).click((function(){n.nextCard()})).appendTo(r),n.$retry=m.createButton({class:"h5p-dialogcards-footer-button h5p-dialogcards-retry h5p-dialogcards-disabled",title:n.params.retry,html:n.params.retry}).click((function(){n.trigger("reset")})).appendTo(r),n.$progress=g("<div>",{id:"h5p-dialogcards-progress-"+e.idCounter,class:"h5p-dialogcards-progress","aria-live":"assertive"}).appendTo(r)):(n.$round=g("<div>",{class:"h5p-dialogcards-round"}).appendTo(r),n.$progress=g("<div>",{class:"h5p-dialogcards-cards-left","aria-live":"assertive"}).appendTo(r)),r},n.updateImageSize=function(){var r=0,t=n.cards[n.currentCardId].getDOM().find(".h5p-dialogcards-card-content");if(n.params.dialogs.forEach((function(a){var e;a.front.image&&(e=a.front.image.height/a.front.image.width*t.get(0).getBoundingClientRect().width)>r&&(r=e),a.back.image&&(e=a.back.image.height/a.back.image.width*t.get(0).getBoundingClientRect().width)>r&&(r=e)})),r>0){var a=r/parseFloat(n.$inner.css("font-size"));a>15&&(a=15),n.cards.forEach((function(r){r.setImageHeight("".concat(a,"em"))}))}},n.initCards=function(r){n.cards=[],n.currentCardId=0,n.params.behaviour.randomCards&&(r=H5P.shuffleArray(r));for(var t=g("<div>",{class:"h5p-dialogcards-cardwrap-set"}),a=0;a<r.length&&!(a>=2);a++){var e=n.getCard(r[a]);e.setProgressText(a+1,r.length),n.cards.push(e);var i=e.getDOM();a===n.currentCardId&&(i.addClass("h5p-dialogcards-current"),n.$current=i),e.addTipToCard(i.find(".h5p-dialogcards-card-content"),"front",a),t.append(i)}return t},n.handleCardTurned=function(r){n.$cardSideAnnouncer.html(r?n.params.cardFrontLabel:n.params.cardBackLabel),n.params.behaviour.enableRetry&&n.currentCardId+1===n.cardIds.length&&n.$retry&&(n.$retry.removeClass("h5p-dialogcards-disabled"),n.truncateRetryButton())},n.updateNavigation=function(){if("normal"===n.params.mode)n.getCurrentSelectionIndex()<n.cardIds.length-1?(n.$next.removeClass("h5p-dialogcards-disabled"),n.$retry.addClass("h5p-dialogcards-disabled")):n.$next.addClass("h5p-dialogcards-disabled"),n.currentCardId>0&&!n.params.behaviour.disableBackwardsNavigation?n.$prev.removeClass("h5p-dialogcards-disabled"):n.$prev.addClass("h5p-dialogcards-disabled"),n.$progress.text(n.params.progressText.replace("@card",n.getCurrentSelectionIndex()+1).replace("@total",n.cardIds.length)),n.cards[n.findCardPosition(n.cards[n.currentCardId].id)].resizeOverflowingText();else{n.$round.text(n.params.round.replace("@round",n.round));var r=n.getCurrentSelectionIndex();n.$progress.text(n.params.cardsLeft.replace("@number",n.cardIds.length-r))}n.trigger("resize")},n.showSummary=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=r?n.cardManager.getPileSizes():n.cardManager.updatePiles(n.results),a=n.results.filter((function(r){return!0===r.result})).length,e=n.results.length-a,i=n.cardPoolSize-a-e,s=t.slice(-1)[0],o=s===n.cardPoolSize,d={round:n.round,results:[{field:"h5p-dialogcards-round-cards-right",score:{value:a,max:e+a}},{field:"h5p-dialogcards-round-cards-wrong",score:{value:e,max:e+a}},{field:"h5p-dialogcards-round-cards-not-shown",score:{value:i}},{field:"h5p-dialogcards-overall-cards-completed",score:{value:s,max:n.cardPoolSize}},{field:"h5p-dialogcards-overall-completed-rounds",score:{value:n.round}}]};o&&(d.done=!0,d.message=n.params.summaryAllDone.replace("@cards",n.cardPoolSize).replace("@max",n.params.behaviour.maxProficiency-1)),n.summaryScreen.update(d),n.summaryScreen.show(),n.hideCards(),n.trigger("resize")},n.showCards=function(){n.$cardwrapperSet.find(".h5p-dialogcards-cardwrap").removeClass("h5p-dialogcards-gone"),n.$footer.removeClass("h5p-dialogcards-gone"),n.cardsShown=!0},n.hideCards=function(){n.$cardwrapperSet.find(".h5p-dialogcards-cardwrap").addClass("h5p-dialogcards-gone"),n.$footer.addClass("h5p-dialogcards-gone"),n.cardsShown=!1},n.nextCard=function(r){void 0!==r&&n.results.push(r),n.cards[n.currentCardId].stopAudio(),n.cardIds.length-n.getCurrentSelectionIndex()!=1?n.gotoCard(n.getCurrentSelectionIndex()+1):"repetition"===n.params.mode&&(n.$progress.text(n.params.cardsLeft.replace("@number",0)),n.cards[n.currentCardId].showSummaryButton(n.showSummary))},n.getCard=function(r){var t=n.cardManager.getCard(r);return t.createButtonListeners(),t},n.findCardPosition=function(r){var t;return n.cards.forEach((function(a,e){t||a.id!==r||(t=e)})),t},n.insertCardToDOM=function(r,t){var a=r.getDOM();void 0===t?a.appendTo(n.$cardwrapperSet):0===t?n.$cardwrapperSet.prepend(a):n.$cardwrapperSet.children().eq(t).after(a),r.addTipToCard(a.find(".h5p-dialogcards-card-content"),"front",t)},n.gotoCard=function(r){if(!(r<0||r>=n.cardIds.length)){var t=n.cards[n.currentCardId];t.stopAudio(),t.getDOM().removeClass("h5p-dialogcards-current");var a=[];r>0&&a.push(r-1),a.push(r),r+1<n.cardIds.length&&a.push(r+1),a.forEach((function(r){if(void 0===n.findCardPosition(n.cardIds[r])){var t=n.getCard(n.cardIds[r]);t.setProgressText(r+1,n.cardIds.length);var a=Math.min(r+1,n.cardIds.length-1),e=n.findCardPosition(n.cardIds[a])||n.cards.length;n.cards.splice(e,0,t),n.insertCardToDOM(t,e)}})),n.resize(),r=n.findCardPosition(n.cardIds[r]),n.cards.forEach((function(t,a){a<r?t.getDOM().addClass("h5p-dialogcards-previous"):(t.getDOM().removeClass("h5p-dialogcards-previous"),a===r&&t.getDOM().addClass("h5p-dialogcards-current"))})),n.currentCardId=r,n.updateNavigation(),n.cards[n.currentCardId].setCardFocus()}},n.prevCard=function(){n.gotoCard(n.getCurrentSelectionIndex()-1)},n.showAllAudio=function(){n.$cardwrapperSet.find(".h5p-audio-inner").removeClass("hide")},n.restartRepetition=function(){n.cardManager.reset(),n.round=0,n.nextRound()},n.nextRound=function(){n.round++,n.summaryScreen.hide(),n.showCards(),n.reset(),n.createDOM(),n.updateNavigation(),n.cards[n.currentCardId].setCardFocus(!0),n.trigger("resize")},n.reset=function(){n.results=[],n.cards[n.currentCardId].stopAudio(n.$current.index()),n.cards.forEach((function(r){r.reset()})),n.currentCardId=0,"normal"===n.params.mode&&n.cards[n.currentCardId].getDOM().addClass("h5p-dialogcards-current"),n.updateNavigation(),n.$retry&&n.$retry.addClass("h5p-dialogcards-disabled"),n.showAllAudio(),n.cards[n.currentCardId].resizeOverflowingText(),n.cards[n.currentCardId].setCardFocus()},n.resize=function(){var r;n.handleOrientationChange();var t,a=null;"number"==typeof window.orientation&&n.$cardwrapperSet.find(".h5p-dialogcards-summary-screen").hasClass("h5p-dialogcards-gone")&&n.params.behaviour.scaleTextNotCard?(n.$inner.toggleClass("h5p-landscape",90===window.orientation),90===window.orientation&&(null!==(t=a=n.computeDisplayLimits())&&void 0!==t&&t.height?n.$cardwrapperSet.css("max-height","".concat(a.height/2,"px")):n.$cardwrapperSet.css("max-height",""))):n.$cardwrapperSet.css("max-height","");var e=0;if(a&&90===window.orientation&&n.params.behaviour.scaleTextNotCard?n.cards.forEach((function(r){r.setImageHeight("")})):n.updateImageSize(),n.params.behaviour.scaleTextNotCard||!1===n.cardsShown||n.determineCardSizes(),n.params.behaviour.scaleTextNotCard&&90===window.orientation&&null!==(r=a)&&void 0!==r&&r.height&&n.$cardwrapperSet.find(".h5p-dialogcards-summary-screen").hasClass("h5p-dialogcards-gone")){var i;n.$cardwrapperSet.css("height","".concat((null===(i=a)||void 0===i?void 0:i.height)/2,"px"))}else{n.$cardwrapperSet.css("height","auto"),n.$cardwrapperSet.children(":not(.h5p-dialogcards-gone)").each((function(){var r=g(this).css("height","initial").outerHeight();if(g(this).css("height","inherit"),e=Math.max(r,e),!g(this).next(".h5p-dialogcards-cardwrap").length){var t=g(this).find(".h5p-dialogcards-cardholder").css("height","initial").outerHeight();e=Math.max(t,e),g(this).find(".h5p-dialogcards-cardholder").css("height","inherit")}}));var s=e/parseFloat(n.$cardwrapperSet.css("font-size"));n.$cardwrapperSet.css("height",s+"em")}n.scaleToFitHeight(),n.truncateRetryButton(),n.cards[n.currentCardId].resizeOverflowingText()},n.determineCardSizes=function(){var r=function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(n);void 0===n.cardSizeDetermined&&(n.cardSizeDetermined=[]),n.$cardwrapperSet.children(":visible").each((function(t){var a=r.cards[t].id;if(-1===r.cardSizeDetermined.indexOf(a)){r.cardSizeDetermined.push(a);var e=g(".h5p-dialogcards-card-content",this),i=g(".h5p-dialogcards-card-text-inner-content",e),n=i[0].getBoundingClientRect().height,s=r.cards[t];s.changeText(s.getAnswer());var o=i[0].getBoundingClientRect().height,d=n>o?n:o,c=parseFloat(i.parent().parent().css("minHeight"));if(d<c&&(d=c),r.hasNoTexts){var l=i.find(".h5p-dialogcards-card-text");d=r.hasNoAudios?0:d-parseFloat(l.css("height")),l.css("height",0)}d/=parseFloat(e.css("fontSize")),i.parent().css("height",d+"em"),s.changeText(s.getText())}}))},n.scaleToFitHeight=function(){if(n.$cardwrapperSet&&n.$cardwrapperSet.is(":visible")&&n.params.behaviour.scaleTextNotCard)if(n.$inner.parents(".h5p-course-presentation").length){var r=n.$inner.parent();n.$inner.parents(".h5p-popup-container").length&&(r=n.$inner.parents(".h5p-popup-container"));var t=r.get(0).getBoundingClientRect().height,a=function(){var r=0;return n.$inner.children().each((function(){var t=g(this);r+=this.getBoundingClientRect().height+parseFloat(t.css("margin-top"))+parseFloat(t.css("margin-bottom"))})),r},i=a(),s=parseFloat(n.$inner.parent().css("font-size")),o=parseFloat(n.$inner.css("font-size"));if(t<i)for(;t<i&&!((o-=e.SCALEINTERVAL)<e.MINSCALE);)n.$inner.css("font-size",o/s+"em"),i=a();else for(var d=!0;d;){if((o+=e.SCALEINTERVAL)>e.MAXSCALE){d=!1;break}var c=o/s;n.$inner.css("font-size",c+"em"),t<=(i=a())&&(d=!1,c=(o-e.SCALEINTERVAL)/s,n.$inner.css("font-size",c+"em"))}}else n.cards[n.currentCardId].resizeOverflowingText()},n.truncateRetryButton=function(){if(n.$retry){n.$retry.removeClass("truncated"),n.$retry.html(n.params.retry);(n.$retry.get(0).getBoundingClientRect().width+parseFloat(n.$retry.css("margin-left"))+parseFloat(n.$retry.css("margin-right")))/n.$retry.parent().get(0).getBoundingClientRect().width>.3&&(n.$retry.addClass("truncated"),n.$retry.html(""))}},n.getCurrentSelectionIndex=function(){return n.cardIds.indexOf(n.cards[n.currentCardId].id)},n.getTitle=function(){return H5P.createTitle(n.contentData&&n.contentData.metadata&&n.contentData.metadata.title?n.contentData.metadata.title:"Dialog Cards")},n.getCurrentState=function(){return{cardPiles:n.cardManager.getPiles(),cardIds:n.cardIds,round:n.round,currentCardId:n.getCurrentSelectionIndex(),results:n.results}},n}a=r,(t=e).prototype=Object.create(a.prototype),t.prototype.constructor=t,p(t,a);var i=e.prototype;return i.computeDisplayLimits=function(){var r=this.getTopWindow(),t=this.isIOS()&&90===window.orientation?{height:screen.width,width:screen.height}:{height:screen.height,width:screen.width};return r=r||{innerHeight:t.height,innerWidth:t.width},{height:Math.min(r.innerHeight,t.height),width:Math.min(r.innerWidth,this.$inner.get(0).offsetWidth)}},i.isIOS=function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},i.getTopWindow=function(r){var t;r=r||window;try{t=r.parent.location.host===window.location.host}catch(r){t=null}return t?r.parent!==r&&r.parent?this.getTopWindow(r.parent):r:null},i.handleOrientationChange=function(){var r=this;this.params.behaviour.scaleTextNotCard&&this.cards.forEach((function(t){"repetition"===r.params.mode&&(t.$buttonTurn.text(90===window.orientation?"":r.params.answer),t.$buttonCorrect.text(90===window.orientation?"":r.params.correctAnswer),t.$buttonIncorrect.text(90===window.orientation?"":r.params.incorrectAnswer)),90!==window.orientation&&r.$cardwrapperSet.css("max-height","")}))},e}(H5P.EventDispatcher);f.idCounter=0,f.SCALEINTERVAL=.2,f.MAXSCALE=16,f.MINSCALE=4;var v=f;H5P.Dialogcards=v}();